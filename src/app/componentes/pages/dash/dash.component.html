<div class="cartas">
    <div class="carta" *ngIf="!cargando && !error">
        <div class="contenedorFondo">
            <img class="fondo" src="assets/Background_image.png" alt="fondo">
            <div class="contenedorUsuario" (click)="editarFoto()">
                <img class="usuario" [src]="usuario?.foto_perfil || 'assets/usuario.png'" [alt]="usuario?.nombre || 'Usuario'">
                <div class="overlay-usuario">
                    <span class="material-symbols-outlined">edit</span>
                </div>
            </div>
        </div>
    
        <div class="detalles">
            <div class="info">
                <p class="nombre">{{ usuario?.nombre || 'Sin nombre registrado' }}</p>
                <p class="especialidad">{{ usuario?.especialidad || 'Especialidad no registrada' }}</p>
                <p class="origen">{{ usuario?.origen || 'Origen no registrado' }}</p>
                <p class="telefono">{{ usuario?.numero_telefono || 'Teléfono no registrado' }}</p>
                <p class="domicilio">{{ usuario?.domicilio || 'Domicilio no registrado' }}</p>
            </div>
            <div class="botones">
                <button class="edit" (click)="abrirModal(false)">
                    <span class="material-symbols-outlined">{{ usuario?.nombre || usuario?.especialidad || usuario?.origen || usuario?.numero_telefono || usuario?.domicilio ? 'edit' : 'add' }}</span>
                </button>
            </div>
        </div>
    
    </div>
    <div class="carta sobreMi">
        <button class="edit editA" (click)="abrirModal(true)">
            <span class="material-symbols-outlined">{{ usuario?.sobre_mi ? 'edit' : 'add' }}</span>
        </button>
        <p class="sobreMiTitulo">Sobre Mi</p>
        <p class="infoSobreMi">
            {{ usuario?.sobre_mi || 'No hay información registrada sobre el profesor.' }}
        </p>
    </div>
    <div class="carta cartaCV" *ngIf="!cargando && !error">
            <div class="curriculum-header">
                <div class="curriculum-title-section">
                    <h2 class="curriculum-titulo">Currículum Vitae</h2>
                </div>
                <div class="curriculum-actions" *ngIf="usuario?.curriculum">
                    <button class="btn-modo" (click)="actualizarCurriculum()">
                        <span class="material-symbols-outlined">edit</span>
                        Actualizar
                    </button>
                    <button class="btn-modo" (click)="generarCurriculum()">
                        <span class="material-symbols-outlined">auto_awesome</span>
                        Generar
                    </button>
                    <button class="btn-modo" (click)="abrirCurriculum()">
                        <span class="material-symbols-outlined">visibility</span>
                        Ver
                    </button>
                    <button class="btn-modo btn-eliminar" (click)="eliminarCurriculum()">
                        <span class="material-symbols-outlined">delete</span>
                        Eliminar
                    </button>
                </div>
            </div>
            <div class="linea-titulo"></div>
            
            <div class="curriculum-content">
                <div *ngIf="usuario?.curriculum" class="curriculum-preview-container">
                    <div class="curriculum-preview">
                        <iframe [src]="curriculumUrl" class="curriculum-iframe" frameborder="0">
                            <p>Tu navegador no puede mostrar el PDF. <a [href]="curriculumUrl" target="_blank">Descargar currículum</a></p>
                        </iframe>
                    </div>
                </div>
    
                <div *ngIf="!usuario?.curriculum" class="sin-curriculum">
                    <div class="sin-curriculum-content">
                        <span class="material-symbols-outlined documento-icon">description</span>
                        <p>No has subido tu currículum todavía</p>
                        <div class="curriculum-buttons">
                            <button class="btn-modo" (click)="actualizarCurriculum()">
                                <span class="material-symbols-outlined">upload</span>
                                Subir
                            </button>
                            <button class="btn-modo" (click)="generarCurriculum()">
                                <span class="material-symbols-outlined">auto_awesome</span>
                                Generar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
    </div>
</div>

<!-- Modal de edición -->
<div class="modal-overlay" *ngIf="mostrarModal" (click)="cerrarModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
        <h2>{{ editandoSobreMi ? 'Editar Sobre Mi' : 'Editar Información Personal' }}</h2>
        
        <div class="modal-body" *ngIf="!editandoSobreMi">
            <div class="form-group">
                <label for="nombre">Nombre</label>
                <input type="text" id="nombre" [(ngModel)]="datosEdicion.nombre" placeholder="Ingresa tu nombre">
            </div>
            <div class="form-group">
                <label for="especialidad">Especialidad</label>
                <input type="text" id="especialidad" [(ngModel)]="datosEdicion.especialidad" placeholder="Ingresa tu especialidad">
            </div>
            <div class="form-group">
                <label for="origen">Origen</label>
                <input type="text" id="origen" [(ngModel)]="datosEdicion.origen" placeholder="Ingresa tu origen">
            </div>
            <div class="form-group">
                <label for="telefono">Teléfono</label>
                <input type="tel" id="telefono" [(ngModel)]="datosEdicion.numero_telefono" placeholder="Ingresa tu teléfono">
            </div>
            <div class="form-group">
                <label for="domicilio">Domicilio</label>
                <input type="text" id="domicilio" [(ngModel)]="datosEdicion.domicilio" placeholder="Ingresa tu domicilio">
            </div>
        </div>

        <div class="modal-body" *ngIf="editandoSobreMi">
            <div class="form-group">
                <label for="sobreMi">Sobre Mi</label>
                <textarea id="sobreMi" [(ngModel)]="datosEdicion.sobre_mi" placeholder="Cuéntanos sobre ti"></textarea>
            </div>
        </div>

        <div class="modal-footer">
            <button class="btn-cancelar" (click)="cerrarModal()">Cancelar</button>
            <button class="btn-guardar" (click)="guardarCambios()">Guardar</button>
        </div>
    </div>
</div>

<!-- Modal de generación de currículum -->
<div class="modal-overlay" *ngIf="mostrarModalGenerarCV" (click)="cerrarModalGenerarCV()">
    <div class="modal-content-generar-cv" (click)="$event.stopPropagation()">
        <div class="modal-header">
            <h2>Generar CV</h2>
            <div class="modal-header-actions">
                <button class="btn-guardar2" (click)="generarPDF()">
                    <span class="material-symbols-outlined">download</span>
                    Descargar PDF
                </button>
                <button class="btn-establecer" (click)="establecerComoCV()">
                    <span class="material-symbols-outlined">check_circle</span>
                    Establecer como CV
                </button>
                <button class="btn-cerrar" (click)="cerrarModalGenerarCV()">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
        </div>
        
        <div class="tabs-container">
            <div class="tabs-header">
                <button class="tab-button" [class.active]="tabActivo === 'personal'" (click)="cambiarTab('personal')">
                    <span class="material-symbols-outlined">person</span>
                    Información Personal
                </button>
                <button class="tab-button" [class.active]="tabActivo === 'experiencia'" (click)="cambiarTab('experiencia')">
                    <span class="material-symbols-outlined">work</span>
                    Experiencia
                </button>
                <button class="tab-button" [class.active]="tabActivo === 'educacion'" (click)="cambiarTab('educacion')">
                    <span class="material-symbols-outlined">school</span>
                    Educación
                </button>
                <button class="tab-button" [class.active]="tabActivo === 'habilidades'" (click)="cambiarTab('habilidades')">
                    <span class="material-symbols-outlined">psychology</span>
                    Habilidades
                </button>
                <button class="tab-button" [class.active]="tabActivo === 'certificados'" (click)="cambiarTab('certificados')">
                    <span class="material-symbols-outlined">workspace_premium</span>
                    Certificados
                </button>
                <button class="tab-button" [class.active]="tabActivo === 'logros'" (click)="cambiarTab('logros')">
                    <span class="material-symbols-outlined">emoji_events</span>
                    Logros
                </button>
                <button class="tab-button" [class.active]="tabActivo === 'referencias'" (click)="cambiarTab('referencias')">
                    <span class="material-symbols-outlined">group</span>
                    Referencias
                </button>
            </div>
        </div>

        <div class="modal-body-generar-cv">
            <div class="editor-cv">
                <div class="tab-content">
                    <!-- Información Personal -->
                    <div *ngIf="tabActivo === 'personal'" class="tab-pane active">
                        <div class="seccion-editor">
                            <h3>Información Personal</h3>
                            <div class="form-row">
                                <div class="form-group half">
                                    <label>Nombre</label>
                                    <input type="text" [(ngModel)]="datosCV.nombre" [value]="usuario?.nombre">
                                </div>
                                <div class="form-group half">
                                    <label>Especialidad</label>
                                    <input type="text" [(ngModel)]="datosCV.especialidad" [value]="usuario?.especialidad">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group half">
                                    <label>Teléfono</label>
                                    <input type="tel" [(ngModel)]="datosCV.telefono" [value]="usuario?.numero_telefono">
                                </div>
                                <div class="form-group half">
                                    <label>Origen</label>
                                    <input type="text" [(ngModel)]="datosCV.origen" [value]="usuario?.origen">
                                </div>
                            </div>
                            <div class="form-group full">
                                <label>Domicilio</label>
                                <input type="text" [(ngModel)]="datosCV.domicilio" [value]="usuario?.domicilio">
                            </div>
                        </div>

                        <div class="seccion-editor">
                            <h3>Sobre Mi</h3>
                            <div class="form-group full">
                                <textarea [(ngModel)]="datosCV.sobreMi" [value]="usuario?.sobre_mi" rows="4"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Experiencia Laboral -->
                    <div *ngIf="tabActivo === 'experiencia'" class="tab-pane active">
                        <div class="seccion-editor">
                            <h3>Experiencia Laboral</h3>
                            <div class="lista-experiencias">
                                <div *ngFor="let exp of experiencias" class="item-lista">
                                    <div class="item-header">
                                        <h4>{{exp.puesto}}</h4>
                                        <div class="item-actions">
                                            <button class="action-btn" (click)="eliminarExperiencia(exp)">
                                                <span class="tooltip">Remover</span>
                                                <span class="material-symbols-outlined">remove</span>
                                            </button>
                                            <button class="action-btn" (click)="editarExperiencia(exp)">
                                                <span class="tooltip">Editar</span>
                                                <span class="material-symbols-outlined">edit</span>
                                            </button>
                                        </div>
                                    </div>
                                    <p>{{exp.empleador}} - {{exp.ciudad}}, {{exp.pais}}</p>
                                    <p>{{exp.fecha_inicio_mes}}/{{exp.fecha_inicio_anio}} - {{exp.fecha_fin_mes ? exp.fecha_fin_mes + '/' + exp.fecha_fin_anio : 'Presente'}}</p>
                                </div>
                            </div>
                            <button class="btn-agregar" (click)="mostrarCamposExperiencia = !mostrarCamposExperiencia">
                                <span class="material-symbols-outlined">{{ mostrarCamposExperiencia ? 'remove' : 'add' }}</span>
                                {{ mostrarCamposExperiencia ? 'Cancelar' : 'Agregar Experiencia' }}
                            </button>
                            <div class="campos-entrada" *ngIf="mostrarCamposExperiencia">
                                <div class="form-row">
                                    <div class="form-group half">
                                        <label>Puesto</label>
                                        <input type="text" [(ngModel)]="nuevaExperiencia.puesto" placeholder="Ingresa el puesto">
                                    </div>
                                    <div class="form-group half">
                                        <label>Empleador</label>
                                        <input type="text" [(ngModel)]="nuevaExperiencia.empleador" placeholder="Ingresa el empleador">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group half">
                                        <label>Ciudad</label>
                                        <input type="text" [(ngModel)]="nuevaExperiencia.ciudad" placeholder="Ingresa la ciudad">
                                    </div>
                                    <div class="form-group half">
                                        <label>País</label>
                                        <input type="text" [(ngModel)]="nuevaExperiencia.pais" placeholder="Ingresa el país">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group half">
                                        <label>Fecha Inicio</label>
                                        <input type="date" [(ngModel)]="nuevaExperiencia.fecha_inicio">
                                    </div>
                                    <div class="form-group half">
                                        <label>Fecha Fin</label>
                                        <input type="date" [(ngModel)]="nuevaExperiencia.fecha_fin">
                                        <span class="fecha-hint">Dejar en blanco si es el trabajo actual</span>
                                    </div>
                                </div>
                                <button class="btn-guardar" (click)="guardarExperiencia(); mostrarCamposExperiencia = false">
                                    <span class="material-symbols-outlined">save</span>
                                    {{ experienciaEditando ? 'Actualizar' : 'Guardar' }}
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Educación -->
                    <div *ngIf="tabActivo === 'educacion'" class="tab-pane active">
                        <div class="seccion-editor">
                            <h3>Educación</h3>
                            <div class="lista-educacion">
                                <div *ngFor="let edu of educacion" class="item-lista">
                                    <div class="item-header">
                                        <h4>{{edu.titulo}}</h4>
                                        <div class="item-actions">
                                            <button class="action-btn" (click)="eliminarEducacion(edu)">
                                                <span class="tooltip">Remover</span>
                                                <span class="material-symbols-outlined">remove</span>
                                            </button>
                                            <button class="action-btn" (click)="editarEducacion(edu)">
                                                <span class="tooltip">Editar</span>
                                                <span class="material-symbols-outlined">edit</span>
                                            </button>
                                        </div>
                                    </div>
                                    <p>{{edu.institucion}} - {{edu.ciudad}}</p>
                                    <p>{{edu.mes_inicio}}/{{edu.ano_inicio}} - {{edu.mes_fin ? edu.mes_fin + '/' + edu.ano_fin : 'Presente'}}</p>
                                </div>
                            </div>
                            <button class="btn-agregar" (click)="mostrarCamposEducacion = !mostrarCamposEducacion">
                                <span class="material-symbols-outlined">{{ mostrarCamposEducacion ? 'remove' : 'add' }}</span>
                                {{ mostrarCamposEducacion ? 'Cancelar' : 'Agregar Educación' }}
                            </button>
                            <div class="campos-entrada" *ngIf="mostrarCamposEducacion">
                                <div class="form-row">
                                    <div class="form-group half">
                                        <label>Título</label>
                                        <input type="text" [(ngModel)]="nuevaEducacion.titulo" placeholder="Ingresa el título">
                                    </div>
                                    <div class="form-group half">
                                        <label>Institución</label>
                                        <input type="text" [(ngModel)]="nuevaEducacion.institucion" placeholder="Ingresa la institución">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group half">
                                        <label>Ciudad</label>
                                        <input type="text" [(ngModel)]="nuevaEducacion.ciudad" placeholder="Ingresa la ciudad">
                                    </div>
                                    <div class="form-group half">
                                        <label>Fecha Inicio</label>
                                        <input type="date" [(ngModel)]="nuevaEducacion.fecha_inicio">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group half">
                                        <label>Fecha Fin</label>
                                        <input type="date" [(ngModel)]="nuevaEducacion.fecha_fin">
                                        <span class="fecha-hint">Dejar en blanco si es el estudio actual</span>
                                    </div>
                                </div>
                                <button class="btn-guardar" (click)="guardarEducacion(); mostrarCamposEducacion = false">
                                    <span class="material-symbols-outlined">save</span>
                                    {{ educacionEditando ? 'Actualizar' : 'Guardar' }}
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Habilidades -->
                    <div *ngIf="tabActivo === 'habilidades'" class="tab-pane active">
                        <div class="seccion-editor">
                            <h3>Habilidades</h3>
                            <div class="lista-habilidades">
                                <div *ngFor="let hab of habilidades" class="item-lista">
                                    <div class="item-header">
                                        <p>{{hab.descripcion}}</p>
                                        <div class="item-actions">
                                            <button class="action-btn" (click)="eliminarHabilidad(hab)">
                                                <span class="tooltip">Remover</span>
                                                <span class="material-symbols-outlined">remove</span>
                                            </button>
                                            <button class="action-btn" (click)="editarHabilidad(hab)">
                                                <span class="tooltip">Editar</span>
                                                <span class="material-symbols-outlined">edit</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button class="btn-agregar" (click)="mostrarCamposHabilidad = !mostrarCamposHabilidad">
                                <span class="material-symbols-outlined">{{ mostrarCamposHabilidad ? 'remove' : 'add' }}</span>
                                {{ mostrarCamposHabilidad ? 'Cancelar' : 'Agregar Habilidad' }}
                            </button>
                            <div class="campos-entrada" *ngIf="mostrarCamposHabilidad">
                                <div class="form-group">
                                    <label>Habilidad</label>
                                    <input type="text" [(ngModel)]="nuevaHabilidad.descripcion" placeholder="Ingresa una habilidad">
                                </div>
                                <button class="btn-guardar" (click)="guardarHabilidad(); mostrarCamposHabilidad = false">
                                    <span class="material-symbols-outlined">save</span>
                                    {{ habilidadEditando ? 'Actualizar' : 'Guardar' }}
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Certificados -->
                    <div *ngIf="tabActivo === 'certificados'" class="tab-pane active">
                        <div class="seccion-editor">
                            <h3>Certificados</h3>
                            <div class="lista-certificados">
                                <div *ngFor="let cert of certificados" class="item-lista">
                                    <div class="item-header">
                                        <h4>{{cert.nombre}}</h4>
                                        <div class="item-actions">
                                            <button class="action-btn" (click)="eliminarCertificado(cert)">
                                                <span class="tooltip">Remover</span>
                                                <span class="material-symbols-outlined">remove</span>
                                            </button>
                                            <button class="action-btn" (click)="editarCertificado(cert)">
                                                <span class="tooltip">Editar</span>
                                                <span class="material-symbols-outlined">edit</span>
                                            </button>
                                        </div>
                                    </div>
                                    <p>{{cert.institucion}}</p>
                                    <p>Fecha de obtención: {{cert.fecha_obtencion}}</p>
                                </div>
                            </div>
                            <button class="btn-agregar" (click)="mostrarCamposCertificado = !mostrarCamposCertificado">
                                <span class="material-symbols-outlined">{{ mostrarCamposCertificado ? 'remove' : 'add' }}</span>
                                {{ mostrarCamposCertificado ? 'Cancelar' : 'Agregar Certificado' }}
                            </button>
                            <div class="campos-entrada" *ngIf="mostrarCamposCertificado">
                                <div class="form-row">
                                    <div class="form-group half">
                                        <label>Nombre del Certificado</label>
                                        <input type="text" [(ngModel)]="nuevoCertificado.nombre" placeholder="Ingresa el nombre del certificado">
                                    </div>
                                    <div class="form-group half">
                                        <label>Institución</label>
                                        <input type="text" [(ngModel)]="nuevoCertificado.institucion" placeholder="Ingresa la institución">
                                    </div>
                                </div>
                                <div class="form-group half">
                                    <label>Fecha de Obtención</label>
                                    <input type="date" [(ngModel)]="nuevoCertificado.fecha_obtencion">
                                </div>
                                <button class="btn-guardar" (click)="guardarCertificado(); mostrarCamposCertificado = false">
                                    <span class="material-symbols-outlined">save</span>
                                    {{ certificadoEditando ? 'Actualizar' : 'Guardar' }}
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Logros -->
                    <div *ngIf="tabActivo === 'logros'" class="tab-pane active">
                        <div class="seccion-editor">
                            <h3>Logros</h3>
                            <div class="lista-logros">
                                <div *ngFor="let logro of logros" class="item-lista">
                                    <div class="item-header">
                                        <h4>{{logro.titulo}}</h4>
                                        <div class="item-actions">
                                            <button class="action-btn" (click)="eliminarLogro(logro)">
                                                <span class="tooltip">Remover</span>
                                                <span class="material-symbols-outlined">remove</span>
                                            </button>
                                            <button class="action-btn" (click)="editarLogro(logro)">
                                                <span class="tooltip">Editar</span>
                                                <span class="material-symbols-outlined">edit</span>
                                            </button>
                                        </div>
                                    </div>
                                    <p>{{logro.descripcion}}</p>
                                    <p>Fecha: {{logro.fecha}}</p>
                                </div>
                            </div>
                            <button class="btn-agregar" (click)="mostrarCamposLogro = !mostrarCamposLogro">
                                <span class="material-symbols-outlined">{{ mostrarCamposLogro ? 'remove' : 'add' }}</span>
                                {{ mostrarCamposLogro ? 'Cancelar' : 'Agregar Logro' }}
                            </button>
                            <div class="campos-entrada" *ngIf="mostrarCamposLogro">
                                <div class="form-group">
                                    <label>Título del Logro</label>
                                    <input type="text" [(ngModel)]="nuevoLogro.titulo" placeholder="Ingresa el título del logro">
                                </div>
                                <div class="form-group">
                                    <label>Descripción</label>
                                    <textarea [(ngModel)]="nuevoLogro.descripcion" placeholder="Describe el logro"></textarea>
                                </div>
                                <div class="form-group">
                                    <label>Fecha</label>
                                    <input type="date" [(ngModel)]="nuevoLogro.fecha">
                                </div>
                                <button class="btn-guardar" (click)="guardarLogro(); mostrarCamposLogro = false">
                                    <span class="material-symbols-outlined">save</span>
                                    {{ logroEditando ? 'Actualizar' : 'Guardar' }}
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Referencias -->
                    <div *ngIf="tabActivo === 'referencias'" class="tab-pane active">
                        <div class="seccion-editor">
                            <h3>Referencias</h3>
                            <div class="lista-referencias">
                                <div *ngFor="let ref of referencias" class="item-lista">
                                    <div class="item-header">
                                        <h4>{{ref.nombre}}</h4>
                                        <div class="item-actions">
                                            <button class="action-btn" (click)="eliminarReferencia(ref)">
                                                <span class="tooltip">Remover</span>
                                                <span class="material-symbols-outlined">remove</span>
                                            </button>
                                            <button class="action-btn" (click)="editarReferencia(ref)">
                                                <span class="tooltip">Editar</span>
                                                <span class="material-symbols-outlined">edit</span>
                                            </button>
                                        </div>
                                    </div>
                                    <p>{{ref.cargo}} - {{ref.institucion}}</p>
                                    <p>Contacto: {{ref.contacto}}</p>
                                    <p>{{ref.comentario}}</p>
                                </div>
                            </div>
                            <button class="btn-agregar" (click)="mostrarCamposReferencia = !mostrarCamposReferencia">
                                <span class="material-symbols-outlined">{{ mostrarCamposReferencia ? 'remove' : 'add' }}</span>
                                {{ mostrarCamposReferencia ? 'Cancelar' : 'Agregar Referencia' }}
                            </button>
                            <div class="campos-entrada" *ngIf="mostrarCamposReferencia">
                                <div class="form-row">
                                    <div class="form-group half">
                                        <label>Nombre</label>
                                        <input type="text" [(ngModel)]="nuevaReferencia.nombre" placeholder="Ingresa el nombre">
                                    </div>
                                    <div class="form-group half">
                                        <label>Cargo</label>
                                        <input type="text" [(ngModel)]="nuevaReferencia.cargo" placeholder="Ingresa el cargo">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group half">
                                        <label>Institución</label>
                                        <input type="text" [(ngModel)]="nuevaReferencia.institucion" placeholder="Ingresa la institución">
                                    </div>
                                    <div class="form-group half">
                                        <label>Contacto</label>
                                        <input type="text" [(ngModel)]="nuevaReferencia.contacto" placeholder="Ingresa el contacto">
                                    </div>
                                </div>
                                <div class="form-group full">
                                    <label>Comentario</label>
                                    <textarea [(ngModel)]="nuevaReferencia.comentario" placeholder="Ingresa un comentario"></textarea>
                                </div>
                                <button class="btn-guardar" (click)="guardarReferencia(); mostrarCamposReferencia = false">
                                    <span class="material-symbols-outlined">save</span>
                                    {{ referenciaEditando ? 'Actualizar' : 'Guardar' }}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="preview-cv">
                <div class="preview-container">
                    <div class="cv-preview">
                        <!-- Barra lateral -->
                        <div class="cv-sidebar">
                            <img [src]="usuario?.foto_perfil || 'assets/usuario.png'" alt="Foto de perfil" class="cv-foto">
                            <h1 class="cv-nombre">{{datosCV.nombre}}</h1>
                            <p class="cv-especialidad">{{datosCV.especialidad}}</p>
                            
                            <h2>Contacto</h2>
                            <div class="cv-contacto">
                                <p><span class="material-symbols-outlined">home</span>{{datosCV.domicilio}}</p>
                                <p><span class="material-symbols-outlined">call</span>{{datosCV.telefono}}</p>
                                <p><span class="material-symbols-outlined">location_on</span>{{datosCV.origen}}</p>
                            </div>

                            <h2>Habilidades</h2>
                            <div class="cv-habilidades">
                                <span class="cv-habilidad" *ngFor="let hab of habilidades">{{hab.descripcion}}</span>
                            </div>
                        </div>

                        <!-- Contenido principal -->
                        <div class="cv-main">
                            <!-- Sobre Mi -->
                            <div class="cv-seccion" *ngIf="datosCV.sobreMi">
                                <h2 class="cv-seccion-titulo">Sobre Mi</h2>
                                <p class="cv-sobre-mi">{{datosCV.sobreMi}}</p>
                            </div>

                            <!-- Experiencia Laboral -->
                            <div class="cv-seccion" *ngIf="experiencias.length > 0">
                                <h2 class="cv-seccion-titulo">Experiencia Laboral</h2>
                                <div class="cv-item" *ngFor="let exp of experiencias">
                                    <h3 class="cv-item-titulo">{{exp.puesto}}</h3>
                                    <p class="cv-item-subtitulo">{{exp.empleador}} - {{exp.ciudad}}, {{exp.pais}}</p>
                                    <p class="cv-item-fecha">{{exp.fecha_inicio_mes}}/{{exp.fecha_inicio_anio}} - {{exp.fecha_fin_mes ? exp.fecha_fin_mes + '/' + exp.fecha_fin_anio : 'Presente'}}</p>
                                </div>
                            </div>

                            <!-- Educación -->
                            <div class="cv-seccion" *ngIf="educacion.length > 0">
                                <h2 class="cv-seccion-titulo">Educación</h2>
                                <div class="cv-item" *ngFor="let edu of educacion">
                                    <h3 class="cv-item-titulo">{{edu.titulo}}</h3>
                                    <p class="cv-item-subtitulo">{{edu.institucion}} - {{edu.ciudad}}</p>
                                    <p class="cv-item-fecha">{{edu.mes_inicio}}/{{edu.ano_inicio}} - {{edu.mes_fin ? edu.mes_fin + '/' + edu.ano_fin : 'Presente'}}</p>
                                </div>
                            </div>

                            <!-- Certificados -->
                            <div class="cv-seccion" *ngIf="certificados.length > 0">
                                <h2 class="cv-seccion-titulo">Certificados</h2>
                                <div class="cv-item" *ngFor="let cert of certificados">
                                    <h3 class="cv-item-titulo">{{cert.nombre}}</h3>
                                    <p class="cv-item-subtitulo">{{cert.institucion}}</p>
                                    <p class="cv-item-fecha">Fecha de obtención: {{cert.fecha_obtencion}}</p>
                                </div>
                            </div>

                            <!-- Logros -->
                            <div class="cv-seccion" *ngIf="logros.length > 0">
                                <h2 class="cv-seccion-titulo">Logros</h2>
                                <div class="cv-item" *ngFor="let logro of logros">
                                    <h3 class="cv-item-titulo">{{logro.titulo}}</h3>
                                    <p class="cv-item-descripcion">{{logro.descripcion}}</p>
                                    <p class="cv-item-fecha">Fecha: {{logro.fecha}}</p>
                                </div>
                            </div>

                            <!-- Referencias -->
                            <div class="cv-seccion" *ngIf="referencias.length > 0">
                                <h2 class="cv-seccion-titulo">Referencias</h2>
                                <div class="cv-item" *ngFor="let ref of referencias">
                                    <h3 class="cv-item-titulo">{{ref.nombre}}</h3>
                                    <p class="cv-item-subtitulo">{{ref.cargo}} - {{ref.institucion}}</p>
                                    <p class="cv-item-contacto">Contacto: {{ref.contacto}}</p>
                                    <p class="cv-item-descripcion" *ngIf="ref.comentario">{{ref.comentario}}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Estado de carga -->
<div class="estado-carga" *ngIf="cargando">
    <p>Cargando información...</p>
</div>

<!-- Estado de error -->
<div class="estado-error" *ngIf="error">
    <p>Ha ocurrido un error al cargar la información.</p>
    <button (click)="cargarInformacionUsuario()">Reintentar</button>
</div>
